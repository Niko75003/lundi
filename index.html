<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.3">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="fr"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="utf-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;Tirage au sort â€“ RÃ©union du lundi&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>:root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>body { margin: 24px; background:#0b0f17; color:#e8eefc; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>h1 { margin: 0 0 12px; font-size: 22px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.row { display:flex; gap:16px; flex-wrap: wrap; align-items: flex-start; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.panel {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #121a28;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid rgba(255,255,255,.08);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-shadow: 0 8px 30px rgba(0,0,0,.25);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.panel.small { width: 320px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.panel.big { flex: 1; min-width: 360px; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.controls { display:flex; gap:10px; flex-wrap: wrap; margin-top: 10px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>button {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background:#2a65ff; color:white; border:0; border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 10px 14px; font-weight: 600; cursor:pointer;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>button.secondary { background: rgba(255,255,255,.08); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>button.danger { background:#ff3b57; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>button:disabled { opacity:.5; cursor:not-allowed; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 12px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.card {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: rgba(255,255,255,.04);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid rgba(255,255,255,.08);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 12px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display:flex; gap:10px; align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>transition: transform .12s ease, border-color .12s ease;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.card:hover { transform: translateY(-1px); border-color: rgba(42,101,255,.45); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.card.inactive { opacity: .45; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.avatar {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 44px; height: 44px; border-radius: 12px; overflow:hidden;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: rgba(255,255,255,.06);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>flex: 0 0 auto;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display:flex; align-items:center; justify-content:center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid rgba(255,255,255,.08);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.avatar img { width:100%; height:100%; object-fit: cover; display:block; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.name { font-weight: 650; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.sub { font-size: 12px; opacity:.75; margin-top:2px; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.winner {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display:flex; gap:12px; align-items:center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 14px; border-radius: 16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid rgba(42,101,255,.35);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: linear-gradient(180deg, rgba(42,101,255,.25), rgba(255,255,255,.03));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.winner .avatar { width: 64px; height:64px; border-radius: 18px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.winner .name { font-size: 18px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.ticker {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 12px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 12px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px dashed rgba(255,255,255,.18);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: rgba(255,255,255,.03);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>min-height: 52px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display:flex; align-items:center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.hint { font-size: 12px; opacity:.75; line-height: 1.4; margin-top: 8px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.tag { font-size: 11px; padding: 3px 8px; border-radius: 999px; background: rgba(255,255,255,.08); opacity:.9; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>label { cursor:pointer; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>input[type="checkbox"] { transform: translateY(1px); }</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;h1&gt;Tirage au sort â€“ RÃ©union du lundi&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="panel small"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="tag" id="statusTag"&gt;â€”&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="controls"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button id="drawBtn"&gt;ğŸ² Tirer au sort&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="secondary" id="resetBtn"&gt;RÃ©initialiser&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="secondary" id="toggleAllBtn"&gt;Tous prÃ©sents&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="danger" id="clearMemoryBtn" title="Oublie les prÃ©sences mÃ©morisÃ©es"&gt;Oublier&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="winner" id="winnerBox" style="display:none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="avatar"&gt;&lt;img id="winnerImg" alt="" /&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div class="name" id="winnerName"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div class="sub" id="winnerSub"&gt;SÃ©lectionnÃ©(e)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="ticker" id="ticker"&gt;Clique â€œTirer au sortâ€.&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="hint"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>- Coche/dÃ©coche les prÃ©sents.&lt;br/&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>- Le tirage se fait uniquement parmi les prÃ©sents.&lt;br/&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>- Les prÃ©sences sont mÃ©morisÃ©es dans le navigateur (localStorage).</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="panel big"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="grid" id="peopleGrid"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// 1) Mets ta liste ici (nom + chemin photo)</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const PEOPLE = [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>{ id: "alice", name: "Alice", photo: "photos/alice.jpg" },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>{ id: "bob", <span class="Apple-converted-space">Â  </span>name: "Bob", <span class="Apple-converted-space">Â  </span>photo: "photos/bob.jpg" },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>{ id: "carla", name: "Carla", photo: "photos/carla.jpg" },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>{ id: "david", name: "David", photo: "photos/david.jpg" },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// Ajoute autant que tu veux...</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// --- State</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const LS_KEY = "tirage_presence_v1";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let present = loadPresence(); // {id: boolean}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let rolling = false;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// --- Elements</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const grid = document.getElementById("peopleGrid");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const drawBtn = document.getElementById("drawBtn");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const resetBtn = document.getElementById("resetBtn");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const toggleAllBtn = document.getElementById("toggleAllBtn");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const clearMemoryBtn = document.getElementById("clearMemoryBtn");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const ticker = document.getElementById("ticker");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const winnerBox = document.getElementById("winnerBox");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const winnerName = document.getElementById("winnerName");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const winnerImg = document.getElementById("winnerImg");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const statusTag = document.getElementById("statusTag");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// --- Init</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderGrid();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>updateStatus();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>drawBtn.addEventListener("click", async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (rolling) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const pool = getPresentPeople();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (pool.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>alert("Personne n'est cochÃ© comme prÃ©sent.");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>rolling = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>drawBtn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerBox.style.display = "none";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const winner = await rollAndPick(pool);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>showWinner(winner);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>rolling = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>drawBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>resetBtn.addEventListener("click", () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerBox.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ticker.textContent = "Clique â€œTirer au sortâ€.";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>toggleAllBtn.addEventListener("click", () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const allPresent = getPresentPeople().length === PEOPLE.length;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>PEOPLE.forEach(p =&gt; present[p.id] = !allPresent);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>savePresence();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>renderGrid();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>updateStatus();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>toggleAllBtn.textContent = allPresent ? "Tous prÃ©sents" : "Tous absents";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>clearMemoryBtn.addEventListener("click", () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>localStorage.removeItem(LS_KEY);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>present = defaultPresence();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>renderGrid();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>updateStatus();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ticker.textContent = "MÃ©moire effacÃ©e. Clique â€œTirer au sortâ€.";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerBox.style.display = "none";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// --- Functions</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function defaultPresence() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// Par dÃ©faut: tout le monde prÃ©sent</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const obj = {};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>PEOPLE.forEach(p =&gt; obj[p.id] = true);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return obj;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function loadPresence() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const raw = localStorage.getItem(LS_KEY);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (!raw) return defaultPresence();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const parsed = JSON.parse(raw);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>// Fallback si quelquâ€™un manque</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const obj = defaultPresence();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>for (const p of PEOPLE) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (typeof parsed[p.id] === "boolean") obj[p.id] = parsed[p.id];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return obj;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>} catch {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return defaultPresence();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function savePresence() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>localStorage.setItem(LS_KEY, JSON.stringify(present));</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function getPresentPeople() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return PEOPLE.filter(p =&gt; present[p.id]);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function updateStatus() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const pool = getPresentPeople().length;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>statusTag.textContent = `${pool} prÃ©sent(s) / ${PEOPLE.length}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>toggleAllBtn.textContent = (pool === PEOPLE.length) ? "Tous absents" : "Tous prÃ©sents";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function renderGrid() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>grid.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const p of PEOPLE) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const card = document.createElement("div");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>card.className = "card" + (present[p.id] ? "" : " inactive");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const avatar = document.createElement("div");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>avatar.className = "avatar";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const img = document.createElement("img");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>img.alt = p.name;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>img.src = p.photo;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>img.onerror = () =&gt; { img.style.display = "none"; avatar.textContent = p.name[0] || "?" };</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>avatar.appendChild(img);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const meta = document.createElement("div");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const name = document.createElement("div");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>name.className = "name";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>name.textContent = p.name;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const sub = document.createElement("div");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>sub.className = "sub";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const label = document.createElement("label");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const cb = document.createElement("input");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>cb.type = "checkbox";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>cb.checked = !!present[p.id];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>cb.addEventListener("change", () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>present[p.id] = cb.checked;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>savePresence();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>renderGrid();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateStatus();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>label.appendChild(cb);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>label.appendChild(document.createTextNode(" prÃ©sent"));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>sub.appendChild(label);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>meta.appendChild(name);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>meta.appendChild(sub);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>card.appendChild(avatar);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>card.appendChild(meta);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>grid.appendChild(card);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>async function rollAndPick(pool) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// Petite animation: affiche des noms au hasard, puis stop sur un gagnant</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const durationMs = 1600;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const tickMin = 45;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const tickMax = 120;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const winner = pool[Math.floor(Math.random() * pool.length)];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const start = performance.now();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let lastShown = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>while (performance.now() - start &lt; durationMs) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const pick = pool[Math.floor(Math.random() * pool.length)];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (!lastShown || pick.id !== lastShown.id) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ticker.textContent = "â€¦" + pick.name;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>lastShown = pick;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>await sleep(randInt(tickMin, tickMax));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// Petit â€œdramaâ€ final</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ticker.textContent = "Et le/la choisi(e) estâ€¦";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>await sleep(350);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ticker.textContent = winner.name;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return winner;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function showWinner(p) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerName.textContent = p.name;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerImg.src = p.photo;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerImg.alt = p.name;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerImg.onerror = () =&gt; { winnerImg.style.display = "none"; };</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>winnerBox.style.display = "flex";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function sleep(ms) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return new Promise(res =&gt; setTimeout(res, ms));</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function randInt(min, max) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return Math.floor(Math.random() * (max - min + 1)) + min;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
